# Thermochemistry
Project on emulating thermochemical reactions that was hacked together during the CZS summer school 2023. 

## The notebook

The basic idea is to take a neural network and substitute it into the Right Hand Side of the differential
equation that describes the thermochemistry.

In this problem we take one time series, and use this to train the neuralODE.

The initial conditions of the one sample  are:
- The total density of the system is: $n_{tot} = 413 \;\mathrm{cm}^{-3}$
- The fractional abundance of oxygen is: $f_O = 3\times10^{-4}$
- The fractional abundance of carbon is $f_C = 5\times10^{-4}$
- The initial temperature of the gas is $T=242\;\mathrm{K}$
The external parameters of the simulation are (do not change over time):
- The cosmic ray ionisation is $\gamma = 2.5e-15 \;\mathrm{s}^{-1}$
- The radiation field is $1.3\;\mathrm{Draine}$ 


# Generating (more) data
The data was generated using the thermochemical simulation code mentioned below. We take just one time series from this dataset.

## More data
The data was generated by cloning the [toy thermochemistry code](https://bitbucket.org/tgrassi/latent_tgas/src/master/) and
pasting the scripts `grid.py` into it. This will produce 10000 randomly initialized timeseries of 
the chemical elements and the temperature. The header of the `.h5` files is as follows: 
```python
["C", "C+", "CO", "CO+", "E", "H", "H+", "H2", "H2O", "H2O+", "H3O+", "HCO+", "O2", "O+", "OH4", "OH+", "Tgas"]
```

Alternatively, you can easily download the dataset from the [Leiden Observatory FTP](https://ftp.strw.leidenuniv.nl/vermarien/czs23_dataset.tar.gz)


# Contact
In case of any other questions, please feel free to reach out to [Gijs VermariÃ«n](vermarien@strw.leidenuniv.nl)
